<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XAUUSD PRO | Terminal Institucional</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;700;900&display=swap');
        body { background-color: #050505; color: #e2e8f0; font-family: 'Inter', sans-serif; overflow: hidden; margin: 0; }
        .mono { font-family: 'JetBrains Mono', monospace; }
        .glass { background: rgba(15, 15, 15, 0.8); border: 1px solid rgba(255, 255, 255, 0.05); backdrop-filter: blur(20px); }
        #main-chart { min-height: 450px; width: 100%; background: #000; }
    </style>
</head>
<body class="h-screen flex flex-col">

    <header class="border-b border-white/5 bg-black p-4 flex justify-between items-center">
        <div class="flex items-center gap-4">
            <div class="bg-[#fbbf24] p-1.5 rounded text-black"><i data-lucide="zap" size="18"></i></div>
            <span class="text-lg font-black tracking-tighter uppercase">NEXUS<span class="text-[#fbbf24]">GOLD</span> PRO</span>
            <div class="hidden md:flex gap-4 text-[10px] font-mono text-slate-500 uppercase ml-4">
                <span class="text-green-500">● LIVE FEED</span>
                <span>LATENCY: 12MS</span>
            </div>
        </div>
        <div class="text-[12px] font-bold mono text-[#fbbf24]" id="price-header">XAUUSD: $2,442.50</div>
    </header>

    <div class="flex-1 flex overflow-hidden">
        <aside class="w-72 border-r border-white/5 bg-black/50 p-6 space-y-8 hidden lg:block">
            <div>
                <h3 class="text-[10px] font-bold text-slate-500 uppercase tracking-widest mb-4">Market Metrics</h3>
                <div class="space-y-3">
                    <div class="flex justify-between text-xs"><span class="text-slate-400">DXY Index</span><span class="text-red-400">104.10 ▼</span></div>
                    <div class="flex justify-between text-xs"><span class="text-slate-400">US10Y Yield</span><span class="text-white">4.22%</span></div>
                </div>
            </div>
            <div class="glass p-4 rounded-xl border-l-2 border-[#fbbf24]">
                <h4 class="text-[10px] font-black text-[#fbbf24] uppercase mb-2">Neural Bias</h4>
                <p class="text-[11px] text-slate-400 leading-relaxed italic">Fuerte acumulación detectada por encima del nivel psicológico de $2,440.</p>
            </div>
        </aside>

        <main class="flex-1 flex flex-col p-4 gap-4 overflow-y-auto">
            <div class="glass p-6 rounded-2xl">
                <h1 id="news-title" class="text-2xl lg:text-4xl font-black tracking-tighter mb-2">Iniciando Terminal de Datos...</h1>
                <p id="news-meta" class="text-[10px] font-mono text-slate-500 uppercase tracking-[0.2em]">Escaneando fuentes institucionales...</p>
            </div>

            <div class="flex-1 relative glass rounded-2xl overflow-hidden min-h-[450px]">
                <div id="main-chart"></div>
            </div>
        </main>
    </div>

    <script>
        // 1. ICONOS
        lucide.createIcons();

        // 2. TOKEN (ASEGÚRATE QUE SEA EL TUYO)
        const API_KEY = '59929dc4d0e025025d3e0609c2532afd1aee94f8';

        // 3. INICIALIZAR GRÁFICO CON DIMENSIONES EXPLÍCITAS
        const chartDiv = document.getElementById('main-chart');
        const chart = LightweightCharts.createChart(chartDiv, {
            layout: { background: { color: 'transparent' }, textColor: '#94a3b8' },
            grid: { vertLines: { color: '#121212' }, horzLines: { color: '#121212' } },
            width: chartDiv.offsetWidth || 800,
            height: 450,
            timeScale: { borderVisible: false }
        });

        const series = chart.addAreaSeries({
            lineColor: '#fbbf24',
            topColor: 'rgba(251, 191, 36, 0.1)',
            bottomColor: 'transparent',
            lineWidth: 2
        });

        // Datos de arranque
        series.setData([
            { time: '2026-01-08', value: 2420 },
            { time: '2026-01-09', value: 2435 },
            { time: '2026-01-10', value: 2442 }
        ]);

        // 4. ACTUALIZAR PRECIO (SIMULADO + VISUAL)
        let currentPrice = 2442.50;
        function updateMarket() {
            currentPrice += (Math.random() - 0.5) * 0.5;
            document.getElementById('price-header').innerText = `XAUUSD: $${currentPrice.toFixed(2)}`;
            const now = new Date().toISOString().split('T')[0];
            series.update({ time: now, value: currentPrice });
        }

        // 5. TRAER NOTICIAS REALES
        async function getNews() {
            try {
                const proxy = "https://api.allorigins.win/get?url=";
                const target = encodeURIComponent(`https://cryptopanic.com/api/v1/posts/?auth_token=${API_KEY}&filter=hot`);
                const res = await fetch(proxy + target);
                const json = await res.json();
                const data = JSON.parse(json.contents);

                if (data.results && data.results.length > 0) {
                    const latest = data.results[0];
                    document.getElementById('news-title').innerText = latest.title;
                    document.getElementById('news-meta').innerText = `SOURCE: ${latest.source.domain.toUpperCase()} | IMPACT: HIGH | REAL-TIME ANALYTICS`;
                }
            } catch (e) {
                // Si falla la API, ponemos una noticia profesional de respaldo
                document.getElementById('news-title').innerText = "Oro se mantiene firme ante la debilidad del Índice Dólar (DXY)";
                document.getElementById('news-meta').innerText = "ANÁLISIS NEXUS: FLUJO INSTITUCIONAL DETECTADO EN EL NIVEL $2,440";
            }
        }

        // Ejecución inicial
        getNews();
        setInterval(updateMarket, 2000);
        setInterval(getNews, 60000);

        // Ajustar el gráfico si se cambia el tamaño de la pantalla
        window.addEventListener('resize', () => {
            chart.applyOptions({ width: chartDiv.offsetWidth });
        });
    </script>
</body>
</html>
